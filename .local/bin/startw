#!/bin/sh -e

export XDG_SESSION_TYPE=wayland 

export MOZ_ENABLE_WAYLAND=1

export _JAVA_OPTIONS='-Dswing.defaultlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true -Djdk.gtk.version=3 -Dswing.crossplatformlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel'
export QT_QPA_PLATFORMTHEME="qt5ct"

# Workaround for Xwayland
# https://github.com/doitsujin/dxvk/wiki/Common-issues#xwayland-issues
export DXVK_CONFIG_FILE=$HOME/.config/dxvk/dxvk.conf

if [ "$1" == "sway" ]; then
	export XDG_CURRENT_DESKTOP=sway 
	export _JAVA_AWT_WM_NONREPARENTING=1
	export QT_WAYLAND_DISABLE_WINDOWDECORATION="1" 
	COMPOSITOR=$1
elif [ "$1" != "" ] && [ -x "$(command -v $1)" ]; then
	gsettings set org.gnome.desktop.wm.preferences button-layout 'appmenu:minimize,maximize,close'
	export XDG_CURRENT_DESKTOP=$1
	COMPOSITOR=$1
fi

if [ "$COMPOSITOR" != "" ]; then
	exec $COMPOSITOR
else 
	echo "no compositor specified"
fi

